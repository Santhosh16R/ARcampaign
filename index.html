<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>AR Video Playback</title>
  <script type="importmap">
    {
      "imports": {
        "three": "https://unpkg.com/three@0.160.0/build/three.module.js",
        "three/addons/": "https://unpkg.com/three@0.160.0/examples/jsm/",
        "mindar-image-three":"https://cdn.jsdelivr.net/npm/mind-ar@1.2.5/dist/mindar-image-three.prod.js"
      }
    }
  </script>
  <script type="module">
    import * as THREE from 'three';
    import { MindARThree } from 'mindar-image-three';

    const mindarThree = new MindARThree({
      container: document.querySelector("#container"),
      imageTargetSrc: "./Image/Knowyourleader.mind"
    });

    const { renderer, scene, camera } = mindarThree;
    const anchor = mindarThree.addAnchor(0);
    const geometry = new THREE.PlaneGeometry(1, 0.55);
    const material = new THREE.MeshBasicMaterial({ color: 0xffffff, transparent: true, opacity: 0 });
    const plane = new THREE.Mesh(geometry, material);
    anchor.group.add(plane);

    // Video
    const video = document.createElement('video');
    video.src = './Videos/Video1.mp4'; // Change to your video file path
    video.loop = true;
    video.muted = false;
    video.setAttribute('webkit-playsinline', 'webkit-playsinline');
    video.setAttribute('playsinline', 'playsinline');
    video.setAttribute('crossorigin', 'anonymous');

    const start = async () => {
      await mindarThree.start();
      renderer.setAnimationLoop(() => {
        renderer.render(scene, camera);
      });
      video.play(); // Start playing the video
      
      // Audio initialization moved inside start() function
      const audio = document.createElement('audio');
      audio.src = './Videos/Video1.mp4'; // Same source as video
      audio.loop = true;
      audio.muted = true;
      audio.play(); // Start playing the audio
    }

    const startButton = document.querySelector("#startButton");
    const stopButton = document.querySelector("#stopButton");

    startButton.addEventListener("click", () => {
      start();
    });

    stopButton.addEventListener("click", () => {
      mindarThree.stop();
      mindarThree.renderer.setAnimationLoop(null);
      video.pause(); // Stop the video
      audio.pause(); // Stop the audio
    });
  </script>
  <style>
    body {
      margin: 0;
    }
    #container {
      width: 100vw;
      height: 100vh;
      position: relative;
      overflow: hidden;
    }
    #control {
      position: fixed;
      top: 0;
      left: 0;
      z-index: 2;
    }
  </style>
</head>
<body>
  <div id="control">
    <button id="startButton">Start</button>
    <button id="stopButton">Stop</button>
  </div>
  <div id="container"></div>
</body>
</html>
